<local:BaseUserControl x:Class="glFTPd_Commander.Views.UserInfoView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:glFTPd_Commander.Views"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="1430">

    <local:BaseUserControl.Resources>
        <ToolTip x:Key="FlagsHelpTooltip" MaxWidth="600">
            <TextBlock xml:space="preserve">Flagname       	Flag	Description
------------------------------------------------------------------------
SITEOP		1	Siteoperator, has access to most commands.
GADMIN		2	Groupadmin of at least one of the user's public
			groups,	private groups have no such thing.
			Use 'site chgadmin' to give or take this flag.
GLOCK		3	User cannot change group.
EXEMPT		4	By default allows to log in when site is full,
			to do 'site idle 0' (same as IDLER flag) and
			exempts from the sim_xfers limit in config file.
COLOR		5	Enables having colors in listings and other
			serverreplies. Can also be changed via the
			'site color' command.
DELETED		6	User is deleted.
			Use 'site deluser' to give or 'site readd' to
			take this flag.
USEREDIT	7	"Co-Siteop"
ANONYMOUS	8	Anonymous user (per-session like login).
			No DELE, RMD or RNTO/RNFR; '!' on login is
			ignored and the userfile doesn't get updated
			with stats (serves as template - use external
			scripts if transfer stats must be recorded).
NUKE		A	Allows to use 'site nuke/reqlog'.
UNNUKE		B	Allows to use 'site unnuke/reqlog'.
UNDUPE		C	Allows to use 'site undupe/predupe'.
KICK		D	Allows to use 'site kick'.
KILL		E	Allows to use 'site kill/swho'.
TAKE		F	Allows to use 'site take'.
GIVE		G	Allows to use 'site give'.
USERS		H	Allows to use 'site user/users/ginfo'.
IDLER		I	Allows to idle forever.
CUSTOM1	J	Custom flag 1
CUSTOM2	K	Custom flag 2
CUSTOM3	L	Custom flag 3
CUSTOM4	M	Custom flag 4
CUSTOM5	N	Custom flag 5

Custom flags can be used in the config file to give some users access to
certain things without having to use private groups. These flags will
only show up in 'site flags' if they're turned on. Custom flags up to
'Z' can be used.

Note: flag 1 is not GOD mode, you must have the correct flags for the
actions you wish to perform.
Note: a user with flag 1 DOES NOT WANT flag 2.
Note: flags A-H can have their access changed through the -flag
permissions in the config file.</TextBlock>
        </ToolTip>
    </local:BaseUserControl.Resources>
    <ScrollViewer VerticalScrollBarVisibility="Auto">

        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label Content="User Information"
           Grid.Row="0"
           Grid.Column="0"
           Grid.ColumnSpan="3"
           FontSize="16"
           FontWeight="Bold"
           Margin="0 0 0 20"
           HorizontalAlignment="Center" />

            <!-- First column -->
            <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,0">
                <Label Content="Username:"/>
                <TextBox x:Name="UsernameTextBox" GotFocus="MoveCaretToEnd" Margin="0,0,0,5" LostFocus="UsernameTextBox_LostFocus" Focusable="True"/>

                <Label Content="User Comment:"/>
                <TextBox x:Name="UserCommentTextBox" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="Max 49 symbols" LostFocus="UserCommentTextBox_LostFocus"/>

                <Label Content="Added by:"/>
                <TextBox x:Name="AddedByTextBox" IsReadOnly="True" Margin="0,0,0,5" />

                <Label Content="Time On Today:"/>
                <TextBox x:Name="TimeOnTodayTextBox" IsReadOnly="True" Margin="0,0,0,5" />

                <Label Content="Flags:"/>
                <TextBox x:Name="FlagsTextBox" PreviewTextInput="FlagsInput" Margin="0,0,0,5" ToolTip="{StaticResource FlagsHelpTooltip}" LostFocus="FlagsTextBox_LostFocus"/>

                <Label Content="Ratios:"/>
                <TextBox x:Name="RatiosTextBox" PreviewTextInput="ValueInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="3 = Upload 1 MiB per 3 MiB downloaded, 0 = Unlimited" LostFocus="RatiosTextBox_LostFocus"/>

                <StackPanel Margin="0,0,0,5">
                    <Label Content="Credits:"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBox x:Name="CreditsTextBox" IsReadOnly="True" Width="119" Margin="0,0,10,0"/>
                        <Button x:Name="AddCreditsButton" Content="Add" Margin="0,0,10,0" Click="AddCreditsButton_Click"/>
                        <Button x:Name="TakeCreditsButton" Content="Take" Margin="0,0,0,0" Click="TakeCreditsButton_Click"/>
                    </StackPanel>
                </StackPanel>

                <Label Content="Current Logins:"/>
                <TextBox x:Name="CurrentLoginsTextBox" IsReadOnly="True" Margin="0,0,0,5"/>

                <Label Content="Total Logins:"/>
                <TextBox x:Name="TotalLoginsTextBox" IsReadOnly="True" Margin="0,0,0,5"/>

                <Label Content="Max Logins:"/>
                <TextBox x:Name="MaxLoginsTextBox" PreviewTextInput="ValueInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="0 = Unlimited" LostFocus="MaxLoginsTextBox_LostFocus"/>

                <Label Content="Max Sim Uploads:"/>
                <TextBox x:Name="MaxSimUploadsTextBox" PreviewTextInput="ValueInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="-1 = Unlimited, 0 = None, max 30000" LostFocus="MaxSimUploadsTextBox_LostFocus"/>

                <Label Content="Max Sim Downloads:"/>
                <TextBox x:Name="MaxSimDownloadsTextBox" PreviewTextInput="ValueInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="-1 = Unlimited, 0 = None" LostFocus="MaxSimDownloadsTextBox_LostFocus"/>

                <Label Content="From same IP:"/>
                <TextBox x:Name="FromSameIpTextBox" PreviewTextInput="ValueInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="0 = Unlimited" LostFocus="FromSameIpTextBox_LostFocus"/>
            </StackPanel>

            <!-- Second column -->
            <StackPanel Grid.Row="1" Grid.Column="1">
                <Label Content="Created:"/>
                <TextBox x:Name="CreatedTextBox" IsReadOnly="True" Margin="0,0,0,5"/>

                <Label Content="Expires:"/>
                <TextBox x:Name="ExpiresTextBox" PreviewTextInput="ExpiresInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="YYYY-mm-dd, 0 = disable" LostFocus="ExpiresTextBox_LostFocus"/>

                <Label Content="Last seen:"/>
                <TextBox x:Name="LastSeenTextBox" IsReadOnly="True" Margin="0,0,0,5"/>

                <Label Content="Idle time:"/>
                <TextBox x:Name="IdleTimeTextBox" PreviewTextInput="ValueInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="In seconds, -1 = Disable" LostFocus="IdleTimeTextBox_LostFocus"/>

                <Label Content="Max Upload Speed:"/>
                <StackPanel Orientation="Horizontal">
                    <TextBox x:Name="MaxUploadSpeedTextBox" IsReadOnly="True" Width="190" Margin="0,0,10,0" ToolTip="0 = Unlimited"/>
                    <Button x:Name="SetMaxUploadSpeedButton" Content="Set" Width="50" Click="SetMaxUploadSpeed_Click"/>
                </StackPanel>

                <Label Content="Max Download Speed:"/>
                <StackPanel Orientation="Horizontal">
                    <TextBox x:Name="MaxDownloadSpeedTextBox" IsReadOnly="True" Width="190" Margin="0,0,10,0" ToolTip="0 = Unlimited"/>
                    <Button x:Name="SetMaxDownloadSpeedButton" Content="Set" Width="50" Click="SetMaxDownloadSpeed_Click"/>
                </StackPanel>

                <Label Content="Times Nuked:"/>
                <TextBox x:Name="TimesNukedTextBox" IsReadOnly="True" Margin="0,0,0,5"/>

                <Label Content="Bytes Nuked:"/>
                <TextBox x:Name="BytesNukedTextBox" IsReadOnly="True" Margin="0,0,0,5"/>

                <Label Content="Weekly Allotment:"/>
                <StackPanel Orientation="Horizontal">
                    <TextBox x:Name="WeeklyAllotmentTextBox" IsReadOnly="True" Width="190" Margin="0,0,10,0" ToolTip="0 = disabled"/>
                    <Button x:Name="SetAllotmentButton" Content="Set" Width="50" Click="SetAllotmentButton_Click"/>
                </StackPanel>

                <Label Content="Time Limit:"/>
                <TextBox x:Name="TimeLimitTextBox" PreviewTextInput="ValueInput" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="In minutes, 0 = Unlimited" LostFocus="TimeLimitTextBox_LostFocus"/>

                <Label Content="Timeframe:"/>
                <TextBox x:Name="TimeframeTextBox" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="8 17 for between 08-17" LostFocus="TimeframeTextBox_LostFocus"/>

                <Label Content="Tagline:"/>
                <TextBox x:Name="TaglineTextBox" GotKeyboardFocus="SelectAllText" Margin="0,0,0,5" ToolTip="Max 63 symbols" LostFocus="TaglineTextBox_LostFocus"/>
            </StackPanel>

            <!-- Third column -->
            <Grid Grid.Row="1" Grid.Column="2" Margin="10,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Group and IP Management Content -->
                <StackPanel Grid.Row="0">
                    <!-- Group Management Section -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="250"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="250"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Available Groups -->
                        <StackPanel Grid.Column="0">
                            <Label Content="Available Groups:"/>
                            <ListBox x:Name="AvailableGroupsListBox"
                             Width="250"
                             Height="250"
                             HorizontalAlignment="Left"
                             SelectionMode="Extended"/>
                        </StackPanel>

                        <!-- Add/Remove Group Membership -->
                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="10,0,10,0">
                            <Button x:Name="AddGroupButton"
                            Content="Add →"
                            Width="100"
                            Margin="0,10,0,0"
                            Click="AddGroupButton_Click"/>
                            <Button x:Name="RemoveGroupButton"
                            Content="← Remove"
                            Width="100"
                            Margin="0,10,0,0"
                            Click="RemoveGroupButton_Click"/>
                        </StackPanel>

                        <!-- User's Groups -->
                        <StackPanel Grid.Column="2">
                            <Label Content="User's Groups:"/>
                            <ListBox x:Name="UserGroupsListBox"
                             Width="250"
                             Height="250"
                             HorizontalAlignment="Left"
                             SelectionMode="Extended"/>
                        </StackPanel>

                        <!-- Add/Remove Group Admin -->
                        <StackPanel Grid.Column="3" VerticalAlignment="Center" Margin="10,0,10,0">
                            <Button x:Name="AddGroupAdminButton"
                            Content="Add →"
                            Width="100"
                            Margin="0,10,0,0"
                            Click="AddGroupAdminButton_Click"/>
                            <Button x:Name="RemoveGroupAdminButton"
                            Content="← Remove"
                            Width="100"
                            Margin="0,10,0,0"
                            Click="RemoveGroupAdminButton_Click"/>
                        </StackPanel>

                        <!-- Group Admin Groups -->
                        <StackPanel Grid.Column="4">
                            <Label Content="Group Admin:"/>
                            <ListBox x:Name="GroupAdminListBox"
                             Width="250"
                             Height="250"
                             HorizontalAlignment="Left"
                             SelectionMode="Extended"/>
                        </StackPanel>
                    </Grid>

                    <!-- IP Restrictions Section -->
                    <Label Content="IP Restrictions:" Margin="0,10,0,0"/>
                    <StackPanel Orientation="Horizontal">
                        <DataGrid x:Name="IpRestrictionsDataGrid"
                          Width="250"
                          MaxHeight="450"
                          Margin="0,0,0,5"
                          AutoGenerateColumns="False"
                          HeadersVisibility="Column"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="False"
                          CanUserResizeRows="False"
                          SelectionMode="Single"
                          SelectionUnit="FullRow"
                          CellEditEnding="IpRestrictionsGrid_CellEditEnding"
                          IsReadOnly="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="IP#" Binding="{Binding IpKey}" IsReadOnly="True" Width="60"/>
                                <DataGridTextColumn Header="IP Address" Binding="{Binding IpValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0 5">
                        <Button x:Name="AddIpButton"
                        Content="Add IP"
                        Width="75"
                        Margin="0,0,0,0"
                        Click="AddIpButton_Click"/>
                        <Button x:Name="RemoveIpButton"
                        Content="Remove IP"
                        Width="75"
                        Margin="100,0,0,0"
                        Click="RemoveIpButton_Click"/>
                    </StackPanel>
                    <TextBlock x:Name="NoRestrictionsTextBlock"
                       Text="No IP restrictions configured"
                       FontStyle="Italic"
                       Visibility="Collapsed"/>
                </StackPanel>

                <!-- User Action Buttons at Bottom -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,0">
                    <Button x:Name="UserPurgeButton"
                    Content="Purge User"
                    Width="110"
                    Height="35"
                    Margin="0,0,0,0"
                    Visibility="Collapsed"
                    Background="Red"
                    Click="UserPurge_Click"/>
                    <Button x:Name="UserRemoveButton"
                    Content="Remove User"
                    Width="110"
                    Height="35"
                    Margin="10,0,0,0"
                    Background="Red"
                    Click="UserRemove_Click"/>
                    <Button x:Name="UserReAddButton"
                    Content="ReAdd User"
                    Width="110"
                    Height="35"
                    Margin="10,0,0,0"
                    Visibility="Collapsed"
                    Background="Green"
                    Click="UserReAdd_Click"/>
                </StackPanel>
            </Grid>
        </Grid>
    </ScrollViewer>
</local:BaseUserControl>
